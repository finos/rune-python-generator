# .github/workflows/renovate.yml
# This workflow runs Renovate Bot on a schedule or on demand.
# It uses the configuration file located at .github/renovate.json

name: Renovate

on:
  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:
  # Runs the workflow on a schedule (e.g., every day at 2 AM)
  schedule:
    - cron: '0 2 * * *'

jobs:
  renovate:
    runs-on: ubuntu-latest
    # ðŸ‘‡ Expanded permissions so Renovate can do everything it needs
    permissions:
      contents: write          # push branches, update files
      pull-requests: write     # open/update PRs
      issues: write            # create/update Dependency Dashboard issue
      security-events: read    # read Dependabot vulnerability alerts
    steps:
      # Checks out the repository under $GITHUB_WORKSPACE
      - uses: actions/checkout@v5

      # Runs the Renovate GitHub Action
      - name: Renovate
        uses: renovatebot/github-action@v43
        with:
          token: ${{ secrets.GITHUB_TOKEN }} # required to create PRs/issues
          configurationFile: .github/renovate.json
        env:
          RENOVATE_REPOSITORIES: ${{ github.repository }} # scan current repo

  # Optional: run your build/test workflow after Renovate finishes
  build_and_test:
    needs: renovate
    uses: ./.github/workflows/build-and-test.yml
